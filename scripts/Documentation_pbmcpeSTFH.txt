Function pbmcpeSTFH()

Description 

Obtains estimators of the mean cross product errors of 
the EBLUPs obtained at different time instants under a spatio-temporal 
Fay-Herriot (STFH) model, by a parametric bootstrap method.

Usage

pbmcpeSTFH(formula, nD, nT, vardir, proxmat, nB = 100, model = "ST",
          sigma21_start = 0.5 * median(vardir), rho1_start = 0.5,
          sigma22_start = 0.5 * median(vardir), rho2_start = 0.5,
          data)
Arguments

formula an object of class formula (or one that can be coerced to
that class): a symbolic description of the model to be fitted. The
variables included in formula must have a length equal to D*T and
sorted in the ascending order by the time instant within each
domain. Details of model specification are given under Details.

nD total number of domains.

nT total number of time instants (constant for each domain).

vardir vector containing the M=nD*nT sampling variances for each
domain and time instant. The values must be sorted as the
variables in formula.

proxmat nD*nD proximity matrix or data frame with values in the
interval [0,1] containing the proximities between the row and
column domains. The rows add up to 1. The rows and columns of this
matrix must be sorted by domain as the variables in formula.

nB number of bootstrap replicates. Default value is 100.

model type of model to be chosen between "ST" (correlated
time-effects within domains) or "S" (uncorrelated time-effects
within domains).

sigma21_start Starting value of the area effects variance in the
fitting algorithm. Default value is 0.5*median(vardir).

rho1_start Starting value of the area effects spatial
autocorrelation parameter in the fitting algorithm. Default value
is 0.5.

sigma22_start Starting value of the area-time effects variance in
the fitting algorithm. Default value is 0.5*median(vardir).

rho2_start Starting value of the time autocorrelation parameter of
the area-time effects in the fitting algorithm. Default value is
0.5.

data optional data frame containing the variables named in formula
and vardir. By default the variables are taken from the
environment from which pbmcpeSTFH is called.

Details 

This function uses random number generation. To fix the
seed, use set.seed.

A typical model has the form response ~ terms where response is
the (numeric) response vector and terms is a series of terms which
specifies a linear predictor for response. A terms specification
of the form first + second indicates all the terms in first
together with all the terms in second with duplicates removed.

A formula has an implied intercept term. To remove this use either
y ~ x - 1 or y ~ 0 + x. See formula for more details of allowed
formulae.

Value 

The function returns a list with the following objects:

eblup a nD*nT matrix with the EBLUPs for each of the nT time instants. 

mse a nD*nT matrix containing the parametric bootstrap
mean squared error estimates for the nD domains and nT time
instants.

mcpe a nD*(nT*(nT-1)/2) matrix containing the parametric bootstrap
mean crossed product error estimates for the nD domains, and the 
combinations of time instants 
(1,2),...,(1,nT),(2,3),...,(2,nT),...,(nT-1,nT).

In case that formula, vardir or proxmat contain NA values a
message is printed and no action is done.

Author(s) 

Isabel Molina and Eva Romero.

References 

- Small Area Methods for Poverty and Living Conditions
Estimates (SAMPLE), funded by European Commission, Collaborative
Project 217565, Call identifier FP7-SSH-2007-1.

- Marhuenda, Y., Molina, I. and Morales, D. (2013). Small area
estimation with spatio-temporal Fay-Herriot models. Computational
Statistics and Data Analysis 58, 308-325.

See Also eblupSTFH

Examples 

library(sae)	     # Load library
data(spacetime)      # Load data set 
data(spacetimeprox)  # Load proximity matrix 
source(Function_pbmcpeSTFH)

W <- as.matrix(spacetimeprox)
D <- nrow(spacetimeprox) # number of areas
T <- length(unique(spacetime$Time)) # number of time periods

# Calculate MSEs and MCPEs of EBLUPs under the spatio-temporal Fay-Herriot model
# with AR(1) time effects nested within areas
set.seed(123)
resultMCPE<-pbmcpeSTFH(formula=Y ~ X1 + X2,nD=D,nT=T,vardir=Var,
                       proxmat=W,nB=500,model="ST",data=spacetime)
eblup<-resultMCPE$eblup;eblup
mse<-resultMCPE$mse;mse
mcpe<-resultMCPE$mcpe;mcpe

